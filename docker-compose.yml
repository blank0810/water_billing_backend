version: '3.8'

services:
    water_backend:
        build:
            context: .
            dockerfile: Dockerfile
        volumes:
            - ./:/var/www/html
            - ./vendor:/var/www/html/vendor
        ports:
            - '9000:9000'
        environment:
            - APP_ENV=local
            - APP_DEBUG=true
            - APP_KEY=base64:your-app-key-here
            - DB_CONNECTION=mysql
            - DB_HOST=water_db # Updated to water_db
            - DB_PORT=3306
            - DB_DATABASE=your_database_name
            - DB_USERNAME=your_database_user
            - DB_PASSWORD=your_database_password
        depends_on:
            - water_db # Updated to water_db

    water_db: # Renamed to water_db
        image: mysql:8.0
        volumes:
            - mysql_data:/var/lib/mysql
        environment:
            MYSQL_ROOT_PASSWORD: your_root_password
            MYSQL_DATABASE: your_database_name
            MYSQL_USER: your_database_user
            MYSQL_PASSWORD: your_database_password
        ports:
            - '3306:3306'

    water_nginx: # Renamed to water_nginx
        image: nginx:alpine
        ports:
            - '8000:80'
        volumes:
            - ./:/var/www/html
            - ./nginx/nginx.conf:/etc/nginx/nginx.conf
        depends_on:
            - water_backend # Updated to water_backend

volumes:
    mysql_data:
